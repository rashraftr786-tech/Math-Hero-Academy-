<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Math Hero Academy</title>
    <style>
        :root { --primary: #4CAF50; --secondary: #2196F3; --accent: #ff9800; }
        body { font-family: 'Comic Sans MS', cursive; background: #eef9ff; margin: 0; padding: 10px; text-align: center; }
        
        /* Login Grid */
        #login-screen { max-width: 900px; margin: 20px auto; background: white; padding: 20px; border-radius: 30px; border: 6px solid var(--secondary); }
        .student-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 10px; margin-top: 20px; }
        .student-card { padding: 15px; background: #f8f9fa; border: 2px solid #ddd; border-radius: 12px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .student-card:hover { border-color: var(--secondary); transform: translateY(-3px); background: #e3f2fd; }

        /* Overlay Systems */
        .overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 1000; justify-content: center; align-items: center; }
        .popup-card { background: white; padding: 30px; border-radius: 20px; width: 320px; border: 5px solid var(--secondary); }
        .input-box { width: 90%; padding: 10px; font-size: 1.1rem; margin: 10px 0; border: 2px solid #ccc; border-radius: 8px; text-align: center; }

        /* Dashboard */
        #dashboard { display: none; max-width: 1100px; margin: 0 auto; text-align: left; }
        .flex-container { display: flex; flex-wrap: wrap; gap: 20px; margin-top: 20px; }
        .arena { flex: 2; background: white; padding: 30px; border-radius: 30px; border: 6px solid var(--primary); text-align: center; position: relative; }
        .sidebar { flex: 1; background: white; padding: 20px; border-radius: 20px; border: 4px solid var(--accent); }

        /* Math UI */
        .math-text { font-size: 4rem; text-align: right; letter-spacing: 12px; font-family: monospace; line-height: 1.2; margin-right: 20%; }
        .ans-row { display: flex; justify-content: center; gap: 8px; margin: 20px 0; }
        .digit { width: 50px; height: 75px; font-size: 3rem; text-align: center; border: 3px solid #333; border-radius: 10px; }
        
        .rank-item { display: flex; justify-content: space-between; padding: 8px; border-bottom: 1px solid #eee; align-items: center; }
        .teacher-tools { background: #333; color: white; padding: 20px; border-radius: 15px; margin-top: 30px; text-align: left; }
        button { cursor: pointer; font-family: inherit; font-weight: bold; }
    </style>
</head>
<body>

    <div id="login-screen">
        <h1>üèÜ Math Hero Academy</h1>
        <p>Select your name to enter the arena!</p>
        <div class="student-grid" id="names-grid"></div>
        <button onclick="openTeacherLogin()" style="margin-top:30px; background:none; border:none; color:#888; text-decoration:underline;">Teacher Mode</button>
    </div>

    <div id="pin-overlay" class="overlay">
        <div class="popup-card">
            <h2 id="pin-title">Hello</h2>
            <input type="password" id="pin-field" class="input-box" placeholder="Enter PIN">
            <button onclick="checkPin()" style="width:100%; padding:12px; background:var(--secondary); color:white; border:none; border-radius:8px;">UNLOCK DASHBOARD</button>
            <p onclick="closeOverlays()" style="color:#888; cursor:pointer; margin-top:10px;">Go Back</p>
        </div>
    </div>

    <div id="teacher-overlay" class="overlay">
        <div class="popup-card" style="width:400px; border-color:#333;">
            <h2>üë®‚Äçüè´ Teacher Control</h2>
            <div style="background:#f0f0f0; padding:15px; border-radius:10px; margin-bottom:15px;">
                <h4>Add New Student</h4>
                <input id="new-name" class="input-box" placeholder="Student Name">
                <input id="new-pin" class="input-box" placeholder="Assign PIN">
                <button onclick="addNewStudent()" style="background:var(--primary); color:white; border:none; padding:10px; border-radius:5px; width:100%;">Add to Class</button>
            </div>
            <button onclick="downloadExcel()" style="width:100%; padding:10px; margin-bottom:5px;">üìä Download Excel Report</button>
            <button onclick="shareWhatsApp()" style="width:100%; padding:10px; background:#25D366; color:white; border:none;">üì± WhatsApp Report</button>
            <p onclick="closeOverlays()" style="color:#888; cursor:pointer; margin-top:10px;">Close Panel</p>
        </div>
    </div>

    <div id="dashboard">
        <div class="flex-container">
            <div class="arena">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <h2 id="student-name">Hero: Aazam</h2>
                    <div style="font-size:1.5rem; color:var(--accent);">‚≠ê <span id="star-count">0</span></div>
                </div>
                <div id="math-arena">
                    <div class="math-text" id="problem-display">1234<br>+ 5678</div>
                    <div style="border-bottom:6px solid #333; width:70%; margin:5px auto;"></div>
                    <div class="ans-row" id="ans-row"></div>
                    <button onclick="submitAnswer()" style="padding:15px 40px; background:var(--primary); color:white; border:none; border-radius:15px; font-size:1.5rem;">Check Answer</button>
                </div>
                <button onclick="location.reload()" style="position:absolute; top:10px; right:10px; background:#ff5252; color:white; border:none; padding:5px 10px; border-radius:5px;">Logout</button>
            </div>
            <div class="sidebar">
                <h3 style="color:var(--accent)">üèÜ Class Ranking</h3>
                <div id="rank-list"></div>
            </div>
        </div>
    </div>

    <script>
        // Load students from LocalStorage or use default
        let students = JSON.parse(localStorage.getItem('academy_students')) || [
            { name: "Aazam", pin: "Aazam@2206" },
            { name: "Priya", pin: "Priya@123" }
        ];

        let currentStudent = null;
        let currentAns = 0;

        function renderGrid() {
            const grid = document.getElementById('names-grid');
            grid.innerHTML = '';
            students.forEach(s => {
                const btn = document.createElement('div');
                btn.className = 'student-card';
                btn.innerText = s.name;
                btn.onclick = () => openPin(s);
                grid.appendChild(btn);
            });
        }

        function openPin(s) {
            currentStudent = s;
            document.getElementById('pin-title').innerText = "Hero: " + s.name;
            document.getElementById('pin-overlay').style.display = 'flex';
        }

        function openTeacherLogin() {
            const pass = prompt("Enter Teacher Password:");
            if(pass === "Admin@2026") {
                document.getElementById('teacher-overlay').style.display = 'flex';
            } else { alert("Wrong Password!"); }
        }

        function closeOverlays() {
            document.querySelectorAll('.overlay').forEach(o => o.style.display = 'none');
        }

        function addNewStudent() {
            const name = document.getElementById('new-name').value;
            const pin = document.getElementById('new-pin').value;
            if(name && pin) {
                students.push({name, pin});
                localStorage.setItem('academy_students', JSON.stringify(students));
                renderGrid();
                alert(name + " added!");
                document.getElementById('new-name').value = '';
                document.getElementById('new-pin').value = '';
            }
        }

        function checkPin() {
            const val = document.getElementById('pin-field').value;
            if(val === currentStudent.pin) {
                document.getElementById('pin-overlay').style.display = 'none';
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                document.getElementById('student-name').innerText = "Hero: " + currentStudent.name;
                updateStats();
                generateMath();
            } else { alert("Wrong PIN!"); }
        }

        function generateMath() {
            const a = Math.floor(Math.random()*8000)+1000;
            const b = Math.floor(Math.random()*1000)+1000;
            currentAns = a + b;
            document.getElementById('problem-display').innerHTML = `${a}<br>+ ${b}`;
            const row = document.getElementById('ans-row');
            row.innerHTML = '';
            const digits = currentAns.toString().length;
            for(let i=0; i<digits; i++) {
                const input = document.createElement('input');
                input.className = 'digit'; input.maxLength = 1;
                row.prepend(input);
            }
        }

        function submitAnswer() {
            const inputs = Array.from(document.querySelectorAll('.digit')).reverse();
            const val = parseInt(inputs.map(i => i.value).join(''));
            if(val === currentAns) {
                alert("‚≠ê Correct! +10 Stars");
                let s = parseInt(localStorage.getItem('stars_'+currentStudent.name)) || 0;
                localStorage.setItem('stars_'+currentStudent.name, s + 10);
                updateStats();
                generateMath();
            } else { alert("Check your math!"); }
        }

        function updateStats() {
            const s = localStorage.getItem('stars_'+currentStudent.name) || 0;
            document.getElementById('star-count').innerText = s;
            const list = document.getElementById('rank-list');
            list.innerHTML = '';
            const sorted = students.map(st => ({
                name: st.name,
                stars: parseInt(localStorage.getItem('stars_'+st.name)) || 0
            })).sort((a,b) => b.stars - a.stars);

            sorted.forEach((st, i) => {
                let medal = i === 0 ? "ü•á" : i === 1 ? "ü•à" : i === 2 ? "ü•â" : (i+1)+".";
                list.innerHTML += `<div class="rank-item"><span>${medal} ${st.name}</span><span>${st.stars} ‚≠ê</span></div>`;
            });
        }

        function downloadExcel() {
            let csv = "Student,Stars\n";
            students.forEach(s => csv += `${s.name},${localStorage.getItem('stars_'+s.name) || 0}\n`);
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url; a.download = 'Class_Report.csv'; a.click();
        }

        function shareWhatsApp() {
            let text = "*Math Hero Academy Report*\n\n";
            students.forEach(s => {
                let stars = localStorage.getItem('stars_'+s.name) || 0;
                if(stars > 0) text += `üë§ *${s.name}*: ${stars} Stars\n`;
            });
            window.open(`https://wa.me/?text=${encodeURIComponent(text)}`);
        }

        renderGrid();
    </script>
</body>
</html>
                
            
